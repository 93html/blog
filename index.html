<!doctype html><html class="theme-next muse use-motion"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css"><meta name="keywords" content="Hexo, NexT"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1"><meta property="og:type" content="website"><meta property="og:title" content="Zehao&#39;s Blog"><meta property="og:url" content="https://www.93html.com/index.html"><meta property="og:site_name" content="Zehao&#39;s Blog"><meta property="og:locale" content="zh-Hans"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Zehao&#39;s Blog"><script type="text/javascript" id="hexo.configuration">var NexT=window.NexT||{},CONFIG={scheme:"Muse",sidebar:{position:"left",display:"hide"},fancybox:!0,motion:!0,duoshuo:{userId:0,author:"博主"}}</script><title>Zehao's Blog</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-77777540-1","auto"),ga("send","pageview")</script><div class="container one-collumn sidebar-position-left page-home"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Zehao's Blog</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">虽千万里 吾往矣</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section">首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section">归档</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><section id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/2018/04/07/关于-Http-304-的简单记录/" itemprop="url">关于 Http 304 的简单记录</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time itemprop="dateCreated" datetime="2018-04-07T11:34:01+08:00" content="2018-04-07">2018-04-07</time></span></div></header><div class="post-body" itemprop="articleBody"><p>Http 304 Not Modified 表示无需再次传输请求内容，可以使用缓存内容，改状态的 response 不会有响应体，从而达到节省带宽的目的</p><h2 id="ETag"><a href="#ETag" class="headerlink" title="ETag"></a>ETag</h2><p>ETag 相当于资源的指纹，资源内容改变时 ETag 会相应改变，304 的判断依据便是 ETag 的值</p><p>客户端发现响应头中的含有 ETag 便会在下次请求这个资源时，带上 if-none-match 值为 ETag 的请求头，由服务器判断内容是否过期</p><p>ETag 可以在 nginx 配置中开启，也可以由服务器应用处理</p></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/2018/03/11/积极心理学（七）/" itemprop="url">积极心理学（七）</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time itemprop="dateCreated" datetime="2018-03-11T22:11:09+08:00" content="2018-03-11">2018-03-11</time></span></div></header><div class="post-body" itemprop="articleBody"><p>保持乐观的三种方式：付诸行动，想象成功，认知疗法</p></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/2018/03/06/支付宝面试复盘/" itemprop="url">支付宝面试复盘</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time itemprop="dateCreated" datetime="2018-03-06T21:12:34+08:00" content="2018-03-06">2018-03-06</time></span></div></header><div class="post-body" itemprop="articleBody"><p>失败是排除一种通向成功的方式<br></p><div class="post-more-link text-center"><a class="btn" href="/2018/03/06/支付宝面试复盘/#more" rel="contents">阅读全文 &raquo;</a></div></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/2018/02/22/四种常见的-POST-提交数据方式/" itemprop="url">四种常见的 POST 提交数据方式</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time itemprop="dateCreated" datetime="2018-02-22T11:18:57+08:00" content="2018-02-22">2018-02-22 </time></span><span class="post-category">&nbsp; | &nbsp; <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a href="/categories/技术/" itemprop="url" rel="index"><span itemprop="name">技术</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>按说今天是农历新年开工第一天，我们公司很人性化的多给我们放一天假（然后很不人性化的连上8天班…）</p><p>话说昨天终于弄懂了 Postman 里面post 的时候有几种可选择数据格式分别代表什么了，这里简单记录一下</p><h1 id="HTTP-报文格式"><a href="#HTTP-报文格式" class="headerlink" title="HTTP 报文格式"></a>HTTP 报文格式</h1><p>每一个http报文都包含下面的三个结构：状态行、请求头、消息主体，类似于这样<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;method&gt; &lt;request-URL&gt; &lt;version&gt;</div><div class="line">&lt;headers&gt;</div><div class="line"></div><div class="line">&lt;entity-body&gt;</div></pre></td></tr></table></figure><p></p><p>在使用 POST/PUT 时，协议规定数据必须放在主体（entity-body）中，理论上主体中的数据编码方式完全可以由开发者自己决定，通过请求头（headers）中的 Content-Type 字段向服务器告知，主体中使用的是何种编码，下面介绍四种常见的数据编码</p><h1 id="application-x-www-form-urlencoded"><a href="#application-x-www-form-urlencoded" class="headerlink" title="application/x-www-form-urlencoded"></a>application/x-www-form-urlencoded</h1><p>这是浏览器的原生 <code>&lt;form&gt;</code> 的默认数据编码格式，效果类似于这样：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">POST http://www.example.com HTTP/1.1</div><div class="line">Content-Type: application/x-www-form-urlencoded;charset=utf-8</div><div class="line"></div><div class="line">title=test&amp;sub%5B%5D=1&amp;sub%5B%5D=2&amp;sub%5B%5D=3</div></pre></td></tr></table></figure><p></p><p>Content-Type 被指定为 application/x-www-form-urlencoded， 提交的数据按照 key1=val1&amp;key2=val2 的方式进行编码，key 和 val 都进行了 URL 转码</p><h1 id="multipart-form-data"><a href="#multipart-form-data" class="headerlink" title="multipart/form-data"></a>multipart/form-data</h1><p>当需要用表单提交文件时，我们会把 <code>&lt;form&gt;</code> 的 <code>enctype</code> 设置为 <code>multipart/form-data</code>，此时主体编码方式就变为 <code>multipart/form-data</code>，示例如下：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">POST  HTTP/1.1</div><div class="line">Host: www.demo.com</div><div class="line">Cache-Control: no-cache</div><div class="line">Postman-Token: 679d816d-8757-14fd-57f2-fbc2518dddd9</div><div class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW</div><div class="line"></div><div class="line">------WebKitFormBoundary7MA4YWxkTrZu0gW</div><div class="line">Content-Disposition: form-data; name=&quot;key&quot;</div><div class="line"></div><div class="line">value</div><div class="line">------WebKitFormBoundary7MA4YWxkTrZu0gW</div><div class="line">Content-Disposition: form-data; name=&quot;testKey&quot;</div><div class="line"></div><div class="line">testValue</div><div class="line">------WebKitFormBoundary7MA4YWxkTrZu0gW</div><div class="line">Content-Disposition: form-data; name=&quot;imgFile&quot;; filename=&quot;no-file&quot;</div><div class="line">Content-Type: application/octet-stream</div><div class="line"></div><div class="line"></div><div class="line">&lt;data in here&gt;</div><div class="line">------WebKitFormBoundary7MA4YWxkTrZu0gW--</div></pre></td></tr></table></figure><p></p><p>首先请求头中的Content-Type 是multipart/form-data，然后指定一个随机字符串，作为主体中各数据间的分隔符，也就是我们看到的 <code>boundary=xxxx</code>，接着每个数据以 <code>--xxxx</code> 开始，紧接着换行，下面是内容描述信息，接着换2行，接着是数据内容，接着换行，然后以 <code>--xxxx--</code>结尾，最后换行</p><p>文本数据和文件,图片的内容描述是不相同的<br>文本参数:<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Content-Disposition: form-data; name=&quot;key&quot;</div><div class="line">Content-Type: text/plain; charset=UTF-8</div><div class="line">Content-Transfer-Encoding: 8bit</div></pre></td></tr></table></figure><p></p><p>文件参数:<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Content-Disposition: form-data; name=&quot;imgFile&quot;; filename=&quot;no-file&quot;</div><div class="line">Content-Type: application/octet-stream</div><div class="line">Content-Transfer-Encoding: binary</div></pre></td></tr></table></figure><p></p><p>每个换行都是 \r\n</p><h1 id="application-json"><a href="#application-json" class="headerlink" title="application/json"></a>application/json</h1><p>这个类型可以说是目前 Restful api 使用的主流类型了<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">POST http://www.example.com HTTP/1.1 </div><div class="line">Content-Type: application/json;charset=utf-8</div><div class="line"></div><div class="line">&#123;&quot;title&quot;:&quot;test&quot;,&quot;sub&quot;:[1,2,3]&#125;</div></pre></td></tr></table></figure><p></p><p>设置 Content-Type 为 application/json，内容使用 JSON 格式</p><h2 id="text-xml"><a href="#text-xml" class="headerlink" title="text/xml"></a>text/xml</h2><p>这种类型说实话我不太了解，工作中好像很少使用，从网上复制了一段描述：它是一种使用 HTTP 作为传输协议，XML 作为编码方式的远程调用规范。典型的 XML-RPC 请求是这样的：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">POST http://www.example.com HTTP/1.1 </div><div class="line">Content-Type: text/xml</div><div class="line"></div><div class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</div><div class="line">&lt;methodCall&gt;</div><div class="line">    &lt;methodName&gt;examples.getStateName&lt;/methodName&gt;</div><div class="line">    &lt;params&gt;</div><div class="line">        &lt;param&gt;</div><div class="line">            &lt;value&gt;&lt;i4&gt;41&lt;/i4&gt;&lt;/value&gt;</div><div class="line">        &lt;/param&gt;</div><div class="line">    &lt;/params&gt;</div><div class="line">&lt;/methodCall&gt;</div></pre></td></tr></table></figure><p></p><p>XML-RPC 协议简单、功能够用，各种语言的实现都有。它的使用也很广泛，如 WordPress 的 XML-RPC Api，搜索引擎的 ping 服务等等。JavaScript 中，也有现成的库支持以这种方式进行数据交互，能很好的支持已有的 XML-RPC 服务。不过，我个人觉得 XML 结构还是过于臃肿，一般场景用 JSON 会更灵活方便。</p></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/2018/02/17/积极心理学（四）/" itemprop="url">积极心理学（四）</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time itemprop="dateCreated" datetime="2018-02-17T01:28:28+08:00" content="2018-02-17">2018-02-17</time></span></div></header><div class="post-body" itemprop="articleBody"><p>这集提出了一个有意思的问题，决定我们幸福感的究竟是外因还是内因？外因对人们的印象通常都是在一段时间内的，比如被授奖，中彩票，被理想的学校录取等，研究表示，这些事情的发生只能在一段时间内提升我们的幸福感，一段时间后幸福感都会回到之前的水平，反之不幸也是，大部分瘫痪病人在一年后情绪会回到瘫痪前的水平，当然对于无法满足生活基本的人来说，幸福感会比较低，一旦满足基本需求，物质对于幸福感的影响就很小了，我们生活的时代比父辈们更富裕，我们的父辈比我们的祖辈更富裕，可数据显示抑郁病患者的人数却在增加，可见幸福感与富裕程度无关，那么问题是，既然环境与幸福感无关，那我们为什么还要努力工作？课程中的观点是，幸福感与环境无关，但并非意味着幸福感无法提升，幸福感取决于我们的精神状态，取决于我们转变看待世界的方式，而非银行账户的余额，这门课程就是讲述怎样进行转变的。</p><p>Thomas Sowell 就职于斯坦福大学胡佛研究所，他的观点概括来说，将人类分为两个阵营，一个阵营的人持“人性约束观”，另一阵营持“人性非约束观”，持“人性约束观”的人们，认为人性无法改变，人性的缺点是与生俱来的，人们必须承认这点，他们通过建立特定的政体，将有缺陷的人性引向正途，“人性非约束观”认为人性可以不断进步，人性缺陷是可以被完善的，所以他们建立的政体就是完善人性，改良人性。课程中所支持的是“人性约束观”，认为人性无法在短时间内改变，在一生的时间中也不足以发生改变，在我们接受这个事实后，我们要做的是，首先通过研究来理解它们，然后充分利用它们。</p><p>「允许自己做一个凡人」，在我们孩童时期我们都是凡人，长大之后我们逐渐在意外界的看法，逐渐掩饰自己的内心，研究表示当我们努力克制某个想法时，往往会适得其反，一个典型的例子是，接下来的10秒内不要想象粉红色的大象，越是在意不要想，结果满脑子都是粉红色的大象了，泰勒表示他是一个内向的人，曾经他上课前反复告诉自己不要紧张，结果越是克制反而越紧张，而现在他接受这个事实，并「允许自己做一个凡人」，不过分在意紧张感，紧张感反而在上课过程中逐渐流失，这个观点说的比较难理解，我觉得后面举的例子不错，航空工程师想要造一架飞机，需要学习并理解万有引力定律，万有引力是客观事实，无法被改变，如果他不接受这个事实，造出来的飞机就无法使用，如果有人无法接受万有引力，他的生活会充满沮丧，因为他拒绝接受无法改变的事物，相反我们接受万有引力，甚至通过引力来创造体育运动，你能想象在无重力状态下打篮球吗，同样，心理学也必须服从学习并理解人性。</p></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/2018/02/02/积极心理学（三）/" itemprop="url">积极心理学（三）</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time itemprop="dateCreated" datetime="2018-02-02T23:31:22+08:00" content="2018-02-02">2018-02-02</time></span></div></header><div class="post-body" itemprop="articleBody"><h3 id="关于此系列"><a href="#关于此系列" class="headerlink" title="关于此系列"></a>关于此系列</h3><p>最近一段时间意识到自己心理状态并不是很好，无意中在知乎看到<a href="https://www.zhihu.com/question/22437266/answer/42237297" target="_blank" rel="external">“如何评价哈佛大学公开课：幸福课？”Gill的回答</a>，故决定认真学习一下积极心理学，并且在此开一个内容回顾系列，虽然很早就知道哈佛大学幸福课，也有很多人表示学习后很受益，但我曾经对心理学准确的说是所谓的心理咨询行业很排斥，而且自认为心理自我调节能力还不错，所以并没有觉得特别需要补充一些心理学知识，直到我意识到，虽然情绪比较稳定，生活也没太大问题，可为什么长期处于一种低幸福感的状态，我觉得我需要一些帮助，那至于为什么是哈佛幸福课呢，其实我也是没有太多选择的过程，从记忆里首先浮现的就是它，网上一搜都是好评如潮，所以且不管对我起不起效，先试试再说。</p><p>至于为什么上来就是（三），因为我想把我的心得贴和课程一一对应，确切来说我不是从第一节课就萌生写心得的想法，而是在看完第二节课的晚上凌晨0：30分，当时看完之后思考了很多关于“尊重”和“严格”的问题，想着想着有点困了，想找个东西记录一下想法，于是干脆决定开这样一个系列，作为一个完美主义（拖延症）的人来说，做事没有开头是难以接受的，我花了很大的时间纠结要不要先从（一）（二）开始，但我可能需要从头回顾前两节的课程内容，这样一想好像又会很累很没有动力想放弃，最后选择很识时务的先从（三）开始写起，日后可能会补上（一）和（二），也可能不会，也可能连（四）都不会有，但是管他呢，如果我坚持写下去了，才能真正说明积极心理学的有效性。</p><h3 id="问题有多重要"><a href="#问题有多重要" class="headerlink" title="问题有多重要"></a>问题有多重要</h3><p>问题引发思考，我们往往习惯提出负面的问题，“你为什么不快乐？”，“为什么那么多人失败了？”，“我们的关系出什么问题了？”，这些问题很重要，但如果是仅仅问这些问题，会引发更多负面的思考，让我们全神贯注在消极的一面，这会让我们忽视消极的一面，如果我们提出一些积极的问题，“我要如何更快乐？”，“成功者是怎么做到的？”，“我们关系如何更亲密？”，这会让我们思考新的可能性，迎接我们的将是另一番天地。</p><h3 id="摆脱消极不会让我们更积极"><a href="#摆脱消极不会让我们更积极" class="headerlink" title="摆脱消极不会让我们更积极"></a>摆脱消极不会让我们更积极</h3><p>积极心理学认为，人的心理疾病光靠解决问题是不够的，摆脱消极只是收益为0，还需要超越不消极，从而产生兴奋，快乐，和幸福的感觉，就例如我想要强壮的身体，可是我生病了，当医生治好了我病，我只是不再生病，并没有变得更强壮，我还需要走出去参加运动，积极心理学并没有让我们忽略治疗疾病，那些依然是很重要的，只是不够，还需要研究如何让我们更加健康，更加幸福快乐。</p><blockquote><p>积极心理学运动提醒我们，这个领域已经和以往不同了，心理学不再只研究疾病，弱点和伤害，它还研究优势和美德，心理治疗不仅要纠正错误，更要建立积极的价值观，心理学不仅是关于疾病和健康的学问，还包括工作，教育，洞察力，爱情，成长和玩乐，而在追求不断完善自身的同时，积极心理学靠的并不是一厢情愿，自欺或是任意编造，而是试图采用最好的科学方式，来解决人类由于错综复杂的本性，而在行为中遇到的独特问题</p></blockquote></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/2017/08/26/一个小小的感悟/" itemprop="url">一个小小的感悟</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time itemprop="dateCreated" datetime="2017-08-26T11:12:27+08:00" content="2017-08-26">2017-08-26 </time></span><span class="post-category">&nbsp; | &nbsp; <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a href="/categories/随笔/" itemprop="url" rel="index"><span itemprop="name">随笔</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>最近在看「重构与模式」，这本书最核心的一个观点是“重构产生模式”，意思是通过持续不断的重构，逐渐提高代码质量，以此避免设计不足和过度设计的问题</p><p>就观点本身而言没有什么问题，然而在中国大多数的互联网团队中，实践起来会遇到很多难点，以我个人经历而言，一个功能模块从写完那一刻起是什么样的，直到它被抛弃或者重写之前基本不会变，原因是：</p><ol><li>忙着应付业务需求，基本没时间</li><li>就算有时间了还要分配给学习新知识、休息娱乐、社交活动等等，基本没想到去 review 曾经写过的代码</li><li>OK 就算有时间 review 了，也不见得能重构出更好的代码（重构是需要很好的嗅觉，以及对设计模式深入理解的）</li><li>就算真的打算重构了，发现根本没有写单元测试，谁也不能保证重构后不会发生灾难</li><li>最根本的一点，在企业里，自上至下很少有人能真正理解重构的意义，我曾经很多次向领导层反映，需要一定的时间周期来偿还技术债务，结果得到的都不是我希望的答案</li></ol><p>在如此重重阻碍之下，编写优美的代码这个小小的心愿变得过于理想化，昂贵不切实际，认为重构根本推行不起来</p><p>我曾经对此深信不疑，直到我开始读书，我发现了我的一个致命的错误，就是认为代码一定是一开始就是“设计”出来的，认为重新设计一番后，一定可以会更优秀，项目的进步是在无数次毁灭重生中提升的，大错特错！重写只不过是每次犯错后从头再来，愚蠢而且低效，单细胞生物不可能跳过亿万年的进化直接变成人类，写代码亦是如此，大多数伟大的项目并非一人一时之作，持续不断的“演进”，遇到错误及时修正，反复敲打代码，大到架构，小到一个变量的命名，任何点都是可以的改进的，一步一步，不停歇的持续优化，才是真正的重构之道</p><p>荀子曰：不积跬步，无以至千里；不积小流，无以成江海，不是一定要“大破大立”才算重构，可能花个5分钟随手就能完成一次简单的重构，这么一想，这项工作也不是那么难</p><p>做人又何尝不是这个道理呢</p></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/2017/07/01/使用-HOC-抽象-React-组件逻辑/" itemprop="url">使用 HOC 抽象 React 组件逻辑</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time itemprop="dateCreated" datetime="2017-07-01T12:12:36+08:00" content="2017-07-01">2017-07-01 </time></span><span class="post-category">&nbsp; | &nbsp; <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a href="/categories/技术/" itemprop="url" rel="index"><span itemprop="name">技术</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>阅读本文前建议先对 react 高阶组件（HOC），以及 js 装饰器（Decorator）有基本的了解</p><p>首先来看这样2个组件（注意 clickHandler 部分）：</p><ul><li><p>CheckBox</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CheckBox</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  state = &#123;</div><div class="line">    checked: <span class="literal">false</span></div><div class="line">  &#125;;</div><div class="line">  </div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">const</span> &#123; checked &#125; = <span class="keyword">this</span>.state;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div</div><div class="line">        classNames=&#123;classnames(&#123; <span class="attr">active</span>: checked &#125;)&#125;</div><div class="line">        onClick=&#123;<span class="keyword">this</span>.clickHandler&#125; /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  clickHandler = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">this</span>.setState(&#123;</div><div class="line">      checked: !<span class="keyword">this</span>.state.checked</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>Dropdown List</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">DropDownList</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  state = &#123;</div><div class="line">    open: <span class="literal">false</span></div><div class="line">  &#125;;</div><div class="line">  </div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">const</span> &#123; open &#125; = <span class="keyword">this</span>.state;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div&gt;</div><div class="line">        &lt;button onClick=&#123;<span class="keyword">this</span>.clickHandler&#125;&gt;性别&lt;<span class="regexp">/button&gt;</span></div><div class="line"><span class="regexp">        &#123;</span></div><div class="line"><span class="regexp">          open &amp;&amp;</span></div><div class="line"><span class="regexp">          &lt;ul&gt;</span></div><div class="line"><span class="regexp">            &lt;li&gt;男&lt;/</span>li&gt;</div><div class="line">            &lt;li&gt;女&lt;<span class="regexp">/li&gt;</span></div><div class="line"><span class="regexp">          &lt;/u</span>l&gt;</div><div class="line">        &#125;</div><div class="line">      &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">    );</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">  clickHandler = () =&gt; &#123;</span></div><div class="line"><span class="regexp">    this.setState(&#123;</span></div><div class="line"><span class="regexp">      open: !this.state.open</span></div><div class="line"><span class="regexp">    &#125;);</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div></pre></td></tr></table></figure></li></ul><p>看出问题了吗？这两个组件有着几乎一样的 clickHandler 方法！</p><p>有没有方法把这段逻辑抽象出来呢？这里介绍一种使用高阶组件的抽象方式</p><h3 id="使用-HOC-重构"><a href="#使用-HOC-重构" class="headerlink" title="使用 HOC 重构"></a>使用 HOC 重构</h3><p>通过观察，以上这2个组件，基本上就是一个状态控制开和关的逻辑，那么我们可以做一个 Decorator<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> toggleHOC = <span class="function"><span class="params">Wrapper</span> =&gt;</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  state = &#123; <span class="attr">on</span>: <span class="literal">false</span> &#125;;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">const</span> &#123; on &#125; = <span class="keyword">this</span>.state;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> &lt;Wrapper on=&#123;on&#125; onToggle=&#123;this.toggleHandler&#125; /&gt;;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  toggleHandler = () =&gt; &#123;</div><div class="line">    this.setState(&#123; on: !this.state.on &#125;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p></p><p>参数 Wrapper 是一个 React 组件，我们为这个组件的 props 注入2个属性，</p><ul><li>一个布尔值的 on</li><li>一个触发修改 on 的方法 toggleHandler</li></ul><p>最终返回出一个新的组件</p><p>再来修改 CheckBox 和 DropDownList：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">@toggleHOC</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CheckBox</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">const</span> &#123; on, toggleHandler &#125; = <span class="keyword">this</span>.props;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div</div><div class="line">        classNames=&#123;classnames(&#123; <span class="attr">active</span>: on &#125;)&#125;</div><div class="line">        onClick=&#123;toggleHandler&#125; /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@toggleHOC</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">DropDownList</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">const</span> &#123; on, toggleHandler &#125; = <span class="keyword">this</span>.props;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div&gt;</div><div class="line">        &lt;button onClick=&#123;toggleHandler&#125;&gt;性别&lt;<span class="regexp">/button&gt;</span></div><div class="line"><span class="regexp">        &#123;</span></div><div class="line"><span class="regexp">          on &amp;&amp;</span></div><div class="line"><span class="regexp">          &lt;ul&gt;</span></div><div class="line"><span class="regexp">            &lt;li&gt;男&lt;/</span>li&gt;</div><div class="line">            &lt;li&gt;女&lt;<span class="regexp">/li&gt;</span></div><div class="line"><span class="regexp">          &lt;/u</span>l&gt;</div><div class="line">        &#125;</div><div class="line">      &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">    );</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div></pre></td></tr></table></figure><p>完成了！是不是很简单</p><p>HOC 还有很多高级用法，比如有这样的</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@foo(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;) </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;...&#125;</div></pre></td></tr></table></figure><p>和这样的<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> abcHOC = compose(a, b, c);</div><div class="line"></div><div class="line">@abcHOC</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;...&#125;</div></pre></td></tr></table></figure><p></p><p>这些用法以后再讲</p></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/2017/06/26/Github-Fork-之后更新版本/" itemprop="url">Github Fork 之后更新版本</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time itemprop="dateCreated" datetime="2017-06-26T22:00:07+08:00" content="2017-06-26">2017-06-26 </time></span><span class="post-category">&nbsp; | &nbsp; <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a href="/categories/技术/" itemprop="url" rel="index"><span itemprop="name">技术</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>比如说有一个 repo 叫做 a/project，现在被 b 用户 fork 了一份 b/project</p><p>当 a 更新了版本之后，b 如何获取到这份更新呢？</p><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>Git 可以为仓库添加多个 remote，b 用户除了自己的 remote 外，再添加一个 a/project 的原 remote</p><p>然后在 pull 的时候指定到这个 a/project 的 remote 上就可以了</p><h2 id="命令行操作"><a href="#命令行操作" class="headerlink" title="命令行操作"></a>命令行操作</h2><ol><li><p>查看当前 remote</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ git remote -v</div><div class="line">origin  https://github.com/b/project.git (fetch)</div><div class="line">origin  https://github.com/b/project.git (push)</div></pre></td></tr></table></figure></li><li><p>添加上游 remote</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ git remote add upstream https://github.com/a/project.git</div><div class="line">$ git remote -v</div><div class="line">origin  https://github.com/b/project.git (fetch)</div><div class="line">origin  https://github.com/b/project.git (push)</div><div class="line">upstream        https://github.com/a/project.git (fetch)</div><div class="line">upstream        https://github.com/a/project.git (push)</div></pre></td></tr></table></figure></li><li><p>获取上游的分支和提交，master 上的提交会存在本地分支 <code>upstream/master</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ git fetch upstream</div></pre></td></tr></table></figure></li><li><p>切换到 master 分支</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ git checkout master</div></pre></td></tr></table></figure></li><li><p>与 <code>upstream/master</code> 合并</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ git merge upstream/master</div></pre></td></tr></table></figure></li></ol><h2 id="SourceTree-操作"><a href="#SourceTree-操作" class="headerlink" title="SourceTree 操作"></a>SourceTree 操作</h2><ol><li>打开 “仓库-项目设置-添加”，输入 a/project 的地址</li><li>“拉取-从远端拉取：upstream-要拉取的远端分支：master”</li></ol><h2 id="脑洞"><a href="#脑洞" class="headerlink" title="脑洞"></a>脑洞</h2><p>那 b 用户岂不是可以直接 push 到 a/project ？？！<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ git push origin master</div><div class="line">remote: Permission to a/project.git denied to b.</div><div class="line">fatal: unable to access &apos;https://github.com/a/project.git/&apos;: The requested URL returned error: 403</div><div class="line">Pushing to https://github.com/a/project.git</div></pre></td></tr></table></figure><p></p><p>git 会很科学的返回 403 错误，优秀！</p></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/2017/06/08/Linux-从入门到重装——文件与目录权限/" itemprop="url">Linux 从入门到重装——文件与目录权限</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time itemprop="dateCreated" datetime="2017-06-08T15:32:07+08:00" content="2017-06-08">2017-06-08 </time></span><span class="post-category">&nbsp; | &nbsp; <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a href="/categories/技术/" itemprop="url" rel="index"><span itemprop="name">技术</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="查看权限"><a href="#查看权限" class="headerlink" title="查看权限"></a>查看权限</h2><p>通过命令 <code>ls -l</code> 或者 <code>ll</code>，可查看文件或目录的权限<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[root@localhost tmp]# ll /</div><div class="line">total 24</div><div class="line">-rw-r--r--   1 root root    0 Jun  8 00:43 abc</div><div class="line">lrwxrwxrwx   1 root root    7 Jun  7 16:37 bin -&gt; usr/bin</div><div class="line">dr-xr-xr-x   4 root root 4096 Jun  7 08:53 boot</div><div class="line">drwxr-xr-x  20 root root 3340 Jun  7 16:52 dev</div><div class="line">drwxr-xr-x 138 root root 8192 Jun  8 00:36 etc</div></pre></td></tr></table></figure><p></p><p>其中第一列代表代表这个文件的类型和权限，即 <code>-rw-r--r--</code>。</p><h2 id="权限的表示方法"><a href="#权限的表示方法" class="headerlink" title="权限的表示方法"></a>权限的表示方法</h2><p>权限由10个字符组成，第一个字符代表这个文件是“目录、文件或链接文件等”。</p><ul><li>[d] 表示目录</li><li>[-] 表示文件</li><li>[l] 表示链接文件</li><li>[b] 表示设备接口</li><li>[c] 表示串行端口设备</li></ul><p>接下来的字符中，均为 “rwx” 或 “-” 的 3字组合，其中 [r] 表示可读（read），[w] 表示可写（write），[x] 表示可执行（execute），注意这 3个权限的位置是不会变的，如果没有权限，就用 [-] 表示。</p><ul><li>第一组为 “文件所有者的权限”，以文件 “abc” 为例，该文件的所有者权限为 “rw-“，即可读、可写。</li><li>第二组为 “同用户组的权限”。</li><li>第三组为 “其他非本用户组的权限”。</li></ul><h2 id="修改权限"><a href="#修改权限" class="headerlink" title="修改权限"></a>修改权限</h2><p>常用的用户组、所有者、各种身份的权限的修改命令如下：</p><ul><li><code>chgrp</code> 改变文件所属用户组。</li><li><code>chown</code> 改变文件所有者。</li><li><code>chmod</code> 改变文件的权限。</li></ul><p>权限除了用字母表示外，还可以用数字来表示</p><ul><li>[r]: 4</li><li>[w]: 2</li><li>[x]: 1</li><li>每种身份（owner、group、others）各自的三个权限（r、w、x）的分数需要累加的，以 <code>-rwxrwx---</code> 为例：</li><li>owner = rwx = 4+2+1 = 7</li><li>group = rwx = 4+2+1 = 7</li><li>other = — = 0+0+0 = 0</li><li>所以当通过 <code>chmod</code> 设置权限时，该文件的权限数字就是 770，如果要将这个文件的所有权限启用，那么就执行：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[root@localhost test]# ll</div><div class="line">total 0</div><div class="line">-rwxrwx--- 1 root root 0 Jun  8 01:07 a</div><div class="line">[root@localhost test]# chmod 777 a</div><div class="line">[root@localhost test]# ll</div><div class="line">total 0</div><div class="line">-rwxrwxrwx 1 root root 0 Jun  8 01:07 a</div></pre></td></tr></table></figure></li></ul><h2 id="默认权限：umask"><a href="#默认权限：umask" class="headerlink" title="默认权限：umask"></a>默认权限：umask</h2><p>umask 指 “目前用户在新建文件或目录时的权限默认值”<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]# umask</div><div class="line">0022</div><div class="line">[root@localhost ~]# umask -S</div><div class="line">u=rwx,g=rx,o=rx</div></pre></td></tr></table></figure><p></p><ul><li>umask 返回的 4位数字的第一位，代表特殊权限，一会再介绍</li><li>“文件” 默认没有可执行（x）权限，最大值为 666</li><li>”目录“ 的执行（x）权限代表是否可进入，最大值为 777</li><li>umask 返回的默认值是 ”要被减掉的权限“</li><li>666 - 022 = 644 = rw-r–r–</li><li>777 - 022 = 755 = rwxr-xr-x</li></ul><p>更改默认权限：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">[root@localhost test]# umask</div><div class="line">0022</div><div class="line">[root@localhost test]# touch abc</div><div class="line">[root@localhost test]# ll</div><div class="line">total 0</div><div class="line">-rw-r--r--. 1 root root 0 Jun  8 01:19 abc</div><div class="line">[root@localhost test]# umask 002</div><div class="line">[root@localhost test]# touch 123</div><div class="line">[root@localhost test]# ll</div><div class="line">total 0</div><div class="line">-rw-rw-r--. 1 root root 0 Jun  8 01:19 123</div><div class="line">-rw-r--r--. 1 root root 0 Jun  8 01:19 abc</div></pre></td></tr></table></figure><p></p><h2 id="特殊权限：SUID，SGID，SBIT"><a href="#特殊权限：SUID，SGID，SBIT" class="headerlink" title="特殊权限：SUID，SGID，SBIT"></a>特殊权限：SUID，SGID，SBIT</h2><p>除了 r、w、x 之外，还有其他特殊权限（s、t）<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[root@localhost /]# ls -ld /tmp ; ls -l /usr/bin/passwd</div><div class="line">drwxrwxrwt. 17 root root 4096 Jun  8 01:19 /tmp</div><div class="line">-rwsr-xr-x. 1 root root 27832 Jun  9  2014 /usr/bin/passwd</div></pre></td></tr></table></figure><p></p><h3 id="Set-UID"><a href="#Set-UID" class="headerlink" title="Set UID"></a>Set UID</h3><ul><li>当 s 出现在 owner 的 x 权限位置时，例如 <code>-rwsr-xr-x</code>，称为 Set UID，简称 SUID 的特殊权限。</li><li>具有 x 权限。</li><li>SUID 仅对二进制程序有效。</li><li>本权限仅在程序执行时（run-time）有效。</li><li>执行者将具有该程序所有者的权限。</li></ul><p>也就是说，当我们执行 <code>passwd</code> 时，任何人都暂时获得了该程序的所有者权限，也就是 <code>rwx</code>。</p><h3 id="Set-GID"><a href="#Set-GID" class="headerlink" title="Set GID"></a>Set GID</h3><ul><li>当 s 出现在用户组的 x 权限位置时，例如 <code>-rwx--s--x</code>，称为 Set GID，简称 SGID 的特殊权限。</li><li>具备 x 权限。</li><li>可以对目录使用。</li><li>对二进制程序有用。</li><li>执行者在执行过程中将会获得该程序用户组的支持。</li><li>当目录被设置 SGID 权限时，若用户在此目录下具有写入权限，则用户所创建的新文件的用户组与此目录的用户组相同。</li></ul><h3 id="Sticky-Bit"><a href="#Sticky-Bit" class="headerlink" title="Sticky Bit"></a>Sticky Bit</h3><ul><li>SBIT 仅对目录有效。</li><li>当用户对于此目录具有 w，x 权限时，用户在该目录下创建文件或目录时，只有自己与 root 才有权利删除该文件。</li></ul><h3 id="SUID，SGID，SBIT-权限设置"><a href="#SUID，SGID，SBIT-权限设置" class="headerlink" title="SUID，SGID，SBIT 权限设置"></a>SUID，SGID，SBIT 权限设置</h3><p>特殊权限也可以用数字表示，数字形态的权限的那 “三个数字” 的组合，在之前再加一个数字，就代表这几个特殊权限了。</p><ul><li>SUID 为 4</li><li>SGID 为 2</li><li>SBIT 为 1</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">[root@localhost tmp]# touch test</div><div class="line">[root@localhost tmp]# chmod 4755 test; ls -l test</div><div class="line">-rwsr-xr-x. 1 root root 0 Jun  8 01:46 test</div><div class="line">[root@localhost tmp]# chmod 6755 test; ls -l test</div><div class="line">-rwsr-sr-x. 1 root root 0 Jun  8 01:46 test</div><div class="line">[root@localhost tmp]# chmod 6755 test; ls -l test</div><div class="line">-rwsr-sr-x. 1 root root 0 Jun  8 01:46 test</div><div class="line">[root@localhost tmp]# chmod 1755 test; ls -l test</div><div class="line">-rwxr-xr-t. 1 root root 0 Jun  8 01:46 test</div><div class="line">[root@localhost tmp]# chmod 7666 test; ls -l test</div><div class="line">-rwSrwSrwT. 1 root root 0 Jun  8 01:46 test</div></pre></td></tr></table></figure><p>注意大写的 S、T，代表空的权限，由于 7666 不具备 x 权限，S、T 的基本条件无法满足，所以当然是 “空的” 权限。</p></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article></section><nav class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a></nav></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><section class="site-overview sidebar-panel sidebar-panel-active"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="Zehao Zhang"><p class="site-author-name" itemprop="name">Zehao Zhang</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">22</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><span class="site-state-item-count">3</span> <span class="site-state-item-name">分类</span></div><div class="site-state-item site-state-tags"><span class="site-state-item-count">9</span> <span class="site-state-item-name">标签</span></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/93html" target="_blank" title="GitHub">GitHub </a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/zhang-ze-hao-45/activities" target="_blank" title="Zhihu">Zhihu </a></span><span class="links-of-author-item"><a href="http://weibo.com/u/2157997197/" target="_blank" title="Weibo">Weibo </a></span><span class="links-of-author-item"><a href="http://www.linkedin.com/in/%E6%B3%BD%E8%B1%AA-%E5%BC%A0-792887a1" target="_blank" title="LinkedIn">LinkedIn </a></span><span class="links-of-author-item"><a href="https://segmentfault.com/u/zehao" target="_blank" title="Segmentfault">Segmentfault</a></span></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2018</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Zehao Zhang</span> <a href="http://www.miibeian.gov.cn/" target="_blank">沪ICP备16039653号</a></div><div class="powered-by">由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动</div><div class="theme-info">主题 - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script></body></html>